<div id="<%= dom_id persona %>">
  <p>
    <strong>Nombre:</strong>
    <%= persona.nombre %>
  </p>

  <p>
    <strong>Apellido:</strong>
    <%= persona.apellido %>
  </p>

  <hr>

  <h3>Artículos Portados Actualmente</h3>
  <% if persona.articulos.any? %>
    <ul>
      <% persona.articulos.each do |articulo| %>
        <li>
          <%= link_to "#{articulo.marca} #{articulo.modelo}", articulo_path(articulo) %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>Esta persona no tiene artículos asignados actualmente.</p>
  <% end %>

  <hr>

  <h3>Historial de Artículos Portados (Transferencias)</h3>
  <% transferencias = Transferencia.where("portador_anterior_id = ? OR nuevo_portador_id = ?", persona.id, persona.id).order(fecha: :desc) %>
  <% if transferencias.any? %>
    <ul>
      <% transferencias.each do |transferencia| %>
        <li>
          <strong><%= transferencia.fecha %>:</strong>
          <% if transferencia.nuevo_portador_id == persona.id %>
            Recibió el artículo <%= link_to "#{transferencia.articulo.marca} #{transferencia.articulo.modelo}", articulo_path(transferencia.articulo) %>
            de <%= link_to "#{transferencia.portador_anterior.nombre} #{transferencia.portador_anterior.apellido}", persona_path(transferencia.portador_anterior) %>.
          <% else %>
            Transfirió el artículo <%= link_to "#{transferencia.articulo.marca} #{transferencia.articulo.modelo}", articulo_path(transferencia.articulo) %>
            a <%= link_to "#{transferencia.nuevo_portador.nombre} #{transferencia.nuevo_portador.apellido}", persona_path(transferencia.nuevo_portador) %>.
          <% end %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>No hay transferencias registradas para esta persona.</p>
  <% end %>
</div>
